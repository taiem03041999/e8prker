import{r as l,R as e}from"./index.44a37fc8.js";import{a as O,r as T}from"./client.fccac619.js";import{u as S}from"./index.32dc055b.js";import{t as D}from"./turnstile.06070236.js";import{A as w,m as v}from"./index.7f77ebef.js";import"./_commonjsHelpers.f037b798.js";const A=async(t,a)=>{const o=document.querySelector("[name='csrf-token']").content,n=new FormData;return n.set("turnstile_token",a),n.set("authenticity_token",o),n.set("email",t),await fetch("/email-verification-code",{method:"POST",body:n})},y=(t,a)=>A(t,a).then(n=>n.json()).then(n=>n),B=t=>/\d/.test(t),U=t=>/[a-zA-Z]/.test(t),V=t=>t.length>=8&&t.length<=20,h=({validation:t,message:a})=>e.createElement("p",{className:`mb-2 text-sm flex items-center transform duration-600 gap-1 ${t?"text-green-600":"text-zinc-600"}`},e.createElement(w,null,t&&e.createElement(v.svg,{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"text-green-600 w-5 h-5",initial:{opacity:0,x:-10,rotate:-180},animate:{opacity:1,x:0,rotate:0,transition:{duration:.4}},exit:{opacity:0,x:-10,rotate:180}},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))),a),I=({t,show_login_links:a,show_maintenance:o,userForm:n,setUserForm:r,proceedStep2:i,setError:c})=>{const[m,d]=l.exports.useState(!!n.affiliate_code),[g,u]=l.exports.useState(!1),{register:p,watch:s,handleSubmit:f,formState:{isValid:b}}=S({defaultValues:n,mode:"onChange"}),E=s("password"),C=async({email:N,password:F,affiliate_code:L})=>{u(!0),r({email:N,password:F,affiliate_code:L});try{const x=await D("send-code");y(N,x).then(_=>{u(!1),_.success?i():c(_.description)})}catch(x){c(x),u(!1)}},z=()=>e.createElement("button",{type:"submit",id:"signup-button-submit-step-1",className:"disabled:bg-zinc-800 disabled:cursor-not-allowed disabled:hover:bg-zinc-800 cursor-pointer font-semibold py-4 w-full bg-pink-600 rounded-md cursor-pointer hover:bg-pink-700 transition-colors group",disabled:!b},g?e.createElement("div",{className:"flex gap-2 justify-center items-center"},e.createElement("svg",{className:"animate-spin inline h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),t.submitting):e.createElement("div",{className:"group-disabled:text-zinc-700 text-whtie"},t.submit));return e.createElement(e.Fragment,null,o?e.createElement("div",{className:"mt-4 row-start-1 col-start-1 transition-opacity duration-700 relative"},e.createElement("div",{className:"p-5 grid place-items-center"},e.createElement("div",{className:"text-center"},e.createElement("p",{className:"mt-4"},t.maintenance_1),e.createElement("p",{className:"mt-2"},t.maintenance_2)))):e.createElement("div",{id:"signupStep1",className:"mt-4 row-start-1 col-start-1 transition-opacity duration-700"},a&&e.createElement("p",null," ",t.have_account," ",e.createElement("a",{href:"/login",className:"text-pink-500 mb-12"},t.sign_in)),e.createElement("form",{onSubmit:f(C),id:"signup-step1Form"},"  ",e.createElement("div",null,e.createElement("label",{className:"block mt-8 font-medium",htmlFor:"username"},t.email),e.createElement("input",{name:"email",type:"email",...p("email",{required:"required",pattern:{value:/\S+@\S+\.\S+/,message:"Invalid Email"}}),className:"block h-12 w-full bg-black/20 outline-0 rounded p-4 mt-2 focus:ring-blue-500"})),e.createElement("div",null,e.createElement("label",{className:"block mt-6 font-medium",htmlFor:"password"},t.password),e.createElement("input",{name:"password",type:"password",className:"block h-12 w-full bg-black/20 rounded p-4 mt-2 focus:ring-blue-500",...p("password",{required:!0,maxLength:20,minLength:8,pattern:{value:/(?=.*[0-9])(?=.*[a-z]).{8,20}$/}})}),e.createElement("div",{className:"p-2 mt-2"},e.createElement(h,{validation:U(E),message:t.password_lowercase_character}),e.createElement(h,{validation:B(E),message:t.password_digit}),e.createElement(h,{validation:V(E),message:t.password_length}))),e.createElement("div",null,m?e.createElement(e.Fragment,null,e.createElement("label",{className:"mt-8 block font-semibold",htmlFor:"affiliate_code"},t.bonus_code),e.createElement("div",{className:"mt-4 mb-12",id:"step1FormBonusContainer"},e.createElement("input",{name:"affiliate_code",type:"text",className:"disabled:bg-zinc-800 disabled:cursor-not-allowed disabled:text-zinc-500 block h-12 w-full bg-black/20 rounded p-4 mt-2 focus:ring-blue-500",readOnly:!!n.affiliate_code,disabled:!!n.affiliate_code,...p("affiliate_code",{})}))):e.createElement("p",{onClick:()=>d(!0),className:"text-sm cursor-pointer mt-8 mb-4 hover:text-zinc-200 text-zinc-400",id:"step1FormBonusTrigger"},t.have_bonus_code)),e.createElement(z,null)),e.createElement("p",{className:"text-sm text-zinc-500 mt-8 leading-normal"},t.terms)))},W=({t,email:a,setError:o})=>{const[r,i]=l.exports.useState(60),[c,m]=l.exports.useState(!1),d=()=>{m(!0),y(a).then(s=>{m(!1),i(60),s.success||o(s.description)})};l.exports.useEffect(()=>{let s;return r>0&&(s=setInterval(()=>{i(f=>f-1)},1e3)),()=>clearInterval(s)},[r]);const g=()=>{const s=t.retry_in_seconds.replace(/%\{number\}/g,`${r}`);return e.createElement("p",{className:"text-zinc-400 py-2 text-sm text-center"},t.email_verification_code_resend_success," ",s)},u=()=>e.createElement("a",{onClick:d,className:"style-none block text-center py-2 text-sm cursor-pointer hover:text-zinc-200 text-zinc-400"},t.email_verification_code_resend),p=()=>e.createElement("p",{className:"text-zinc-400 italic py-2 text-sm text-center"},t.email_verification_code_sending);return c?p():r>0?g():u()},j=({t,userForm:a,backToStep1:o,setError:n})=>{const{register:r,handleSubmit:i,formState:{isValid:c}}=S({mode:"onChange"}),[m,d]=l.exports.useState(!1),g=async({verificationCode:p})=>{d(!0);const s=document.querySelector("[name='csrf-token']").content,f=await fetch("/sign-up",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":s},body:JSON.stringify({...a,verification_code:p})});if(f.ok)window.location.assign("/sign-up/success");else{const b=await f.json();n(b.description),d(!1)}},u=()=>e.createElement("button",{type:"submit",id:"signup-button-submit-step-2",className:"disabled:bg-zinc-800 disabled:cursor-not-allowed disabled:hover:bg-zinc-800 cursor-pointer font-semibold py-4 w-full bg-pink-600 rounded-md cursor-pointer hover:bg-pink-700 transition-colors group",disabled:!c},m?e.createElement("div",{className:"flex gap-2 justify-center items-center"},e.createElement("svg",{className:"animate-spin inline h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),t.submitting):e.createElement("div",{className:"group-disabled:text-zinc-700 text-whtie"},"Verify & Create Account"));return e.createElement("div",{id:"signupStep2",className:"mt-8 row-start-1 col-start-1"},e.createElement("div",{className:"items-center gap-2 group cursor-pointer rounded py-2 pl-2 pr-4 bg-zinc-700 hover:bg-zinc-600 inline-flex transition-colors",id:"backToStep1"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-4 h-4 text-zinc-300 group-hover:text-zinc-100 transition-colors"},e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})),e.createElement("p",{onClick:o,className:"text-sm text-zinc-300 group-hover:text-zinc-100 transition-colors"},t.back_step1)),e.createElement("p",{className:"mt-8 text-base text-zinc-400"},t.email_verification_code_sent," ",e.createElement("span",{className:"text-white",id:"step2Email"},a.email)),e.createElement("p",{className:"mt-4 text-base text-zinc-400"},t.email_verification_code_check),e.createElement("form",{onSubmit:i(g),className:"mt-8",id:"signup-step2Form"},e.createElement("label",{className:"block font-semibold",htmlFor:"verification_code"},t.verification_code),e.createElement("input",{name:"verification_code",type:"text",id:"step2FormCode",...r("verificationCode",{required:"required"}),className:"block h-12 w-full bg-black/20 outline-0 rounded p-4 mt-2 focus:ring-blue-500"}),e.createElement("div",{className:"mt-4 mb-8"},e.createElement(W,{t,email:a.email,setError:n})),e.createElement(u,null)),e.createElement("p",{className:"text-sm text-zinc-500 mt-8 leading-normal"},t.terms))},q=({message:t,clearError:a})=>{if(!t)return null;const o=8,[n,r]=l.exports.useState(o+1);return l.exports.useEffect(()=>{let i;return n>0?i=setInterval(()=>{r(c=>c-1)},1e3):a(),()=>clearInterval(i)},[n]),e.createElement(w,null,n>1&&e.createElement(v.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100},className:"absolute text-sm top-3 right-3 z-50 bg-red-500 p-4 rounded w-full max-w-xs"},t))},M=({translation:t,affiliate_code:a,show_login_links:o,show_maintenance:n})=>{const[r,i]=l.exports.useState("step-1"),[c,m]=l.exports.useState(null),[d,g]=l.exports.useState({email:"",password:"",affiliate_code:a}),u=()=>{i("step-2")},p=()=>{i("step-1")},s=()=>{m(null)};return e.createElement("div",{className:"grid grid-rows-1 grid-cols-1 relative"},c&&T.exports.createPortal(e.createElement(q,{message:c,clearError:s}),document.getElementById("sign-up-section")),e.createElement(w,{mode:"popLayout"},e.createElement(v.div,{key:r,initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.5}},r==="step-1"&&e.createElement(I,{t,show_login_links:o,show_maintenance:n,userForm:d,setError:m,setUserForm:g,proceedStep2:u}),r==="step-2"&&e.createElement(j,{t,userForm:d,setUserForm:g,backToStep1:p,setError:m}))))},k=document.getElementById("sign-up-root"),P=JSON.parse(k.getAttribute("data")),R=O.createRoot(k);R.render(e.createElement(M,{...P}));